<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ver Incidencia - Sistema Centinela</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Flatpickr para fecha/hora -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

    <!-- Fuentes del sistema Centinela -->
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap"
        rel="stylesheet">

    <!-- Estilos del navbar y footer -->
    <link rel="stylesheet" href="/components/personalization/personalization.css">

    <!-- Estilos principales de la vista -->
    <link rel="stylesheet" href="verIncidencias.css">

    <!-- Assets -->
    <link rel="icon" href="/assets/images/logo.png" type="image/png">
    <link rel="manifest" href="/manifest.json">
</head>

<body>
    <canvas id="particle-canvas"></canvas>
    <br>

    <!-- Contenedor principal -->
    <div class="custom-container">
        <!-- Header -->
        <div class="header-section">
            <div class="header-content">
                <h1 class="main-title">
                    <i class="fas fa-eye"></i>
                    Ver Detalle de Incidencia
                </h1>
                <div class="header-description-text">
                    <i class="fas fa-clipboard-list"></i>
                    "Visualiza toda la información de la incidencia seleccionada"
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- FORMULARIO ÚNICO: INFORMACIÓN DE LA INCIDENCIA -->
        <!-- ============================================= -->
        <div class="form-row">
            <div class="full-width">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle"></i>Información de la Incidencia</h5>
                        <div class="header-actions">
                            <button id="btnVolverLista" class="btn-volver">
                                <i class="fas fa-arrow-left"></i>Volver a la lista
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <form id="formVerIncidencia">
                            <!-- Grid de UNA sola columna -->
                            <div class="form-grid" style="grid-template-columns: 1fr;">
                                <div class="full-width">
                                    <h6 class="section-title"><i class="fas fa-info-circle"></i>Información Básica</h6>
                                </div>

                                <!-- ID de Incidencia (solo lectura) -->
                                <div class="full-width">
                                    <label for="incidenciaId" class="form-label">ID de Incidencia</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-hashtag"></i></span>
                                        <input type="text" class="form-control" id="incidenciaId" readonly>
                                    </div>
                                    <div class="form-help-text">Identificador único de la incidencia</div>
                                </div>

                                <!-- Organización (solo lectura) -->
                                <div class="full-width">
                                    <label for="organization" class="form-label">Organización</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-building"></i></span>
                                        <input type="text" class="form-control" id="organization" readonly>
                                    </div>
                                    <div class="form-help-text">Organización a la que pertenece la incidencia</div>
                                </div>

                                <!-- Sucursal (solo lectura) -->
                                <div class="full-width">
                                    <label for="sucursalIncidencia" class="form-label">Sucursal</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-store"></i></span>
                                        <input type="text" class="form-control" id="sucursalIncidencia" readonly>
                                    </div>
                                    <div class="form-help-text">Sucursal donde ocurrió la incidencia</div>
                                </div>

                                <!-- Categoría (solo lectura) -->
                                <div class="full-width">
                                    <label for="categoriaIncidencia" class="form-label">Categoría</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-tags"></i></span>
                                        <input type="text" class="form-control" id="categoriaIncidencia" readonly>
                                    </div>
                                    <div class="form-help-text">Categoría de la incidencia</div>
                                </div>

                                <!-- Subcategoría (solo lectura) -->
                                <div class="full-width">
                                    <label for="subcategoriaIncidencia" class="form-label">Subcategoría</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-tag"></i></span>
                                        <input type="text" class="form-control" id="subcategoriaIncidencia" readonly>
                                    </div>
                                    <div class="form-help-text">Subcategoría específica (si aplica)</div>
                                </div>

                                <!-- Nivel de Riesgo con badge -->
                                <div class="full-width">
                                    <label for="nivelRiesgo" class="form-label">Nivel de Riesgo</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i
                                                class="fas fa-exclamation-triangle"></i></span>
                                        <div class="form-control badge-container" id="nivelRiesgoContainer">
                                            <span class="riesgo-badge" id="nivelRiesgoBadge"></span>
                                        </div>
                                    </div>
                                    <div class="form-help-text">Criticidad de la incidencia</div>
                                </div>

                                <!-- Estado con badge -->
                                <div class="full-width">
                                    <label for="estadoIncidencia" class="form-label">Estado</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-check-circle"></i></span>
                                        <div class="form-control badge-container" id="estadoContainer">
                                            <span class="estado-badge" id="estadoBadge"></span>
                                        </div>
                                    </div>
                                    <div class="form-help-text">Estado actual de la incidencia</div>
                                </div>

                                <!-- Fecha y Hora de creación -->
                                <div class="full-width">
                                    <label for="fechaCreacion" class="form-label">Fecha de Creación</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-calendar-plus"></i></span>
                                        <input type="text" class="form-control" id="fechaCreacion" readonly>
                                    </div>
                                    <div class="form-help-text">Fecha y hora en que se registró la incidencia</div>
                                </div>

                                <!-- Fecha y Hora del incidente -->
                                <div class="full-width">
                                    <label for="fechaHoraIncidencia" class="form-label">Fecha y Hora del
                                        Incidente</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-calendar-alt"></i></span>
                                        <input type="text" class="form-control" id="fechaHoraIncidencia" readonly>
                                    </div>
                                    <div class="form-help-text">Fecha y hora en que ocurrió la incidencia</div>
                                </div>

                                <!-- Fecha de finalización (si está finalizada) -->
                                <div class="full-width" id="fechaFinalizacionContainer" style="display: none;">
                                    <label for="fechaFinalizacion" class="form-label">Fecha de Finalización</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-calendar-check"></i></span>
                                        <input type="text" class="form-control" id="fechaFinalizacion" readonly>
                                    </div>
                                    <div class="form-help-text">Fecha y hora en que se finalizó la incidencia</div>
                                </div>

                                <!-- Reportado por -->
                                <div class="full-width">
                                    <label for="reportadoPor" class="form-label">Reportado por</label>
                                    <div class="input-group">
                                        <span class="input-group-icon"><i class="fas fa-user"></i></span>
                                        <input type="text" class="form-control" id="reportadoPor" readonly>
                                    </div>
                                    <div class="form-help-text">Usuario que reportó la incidencia</div>
                                </div>

                                <!-- Descripción/Detalles -->
                                <div class="full-width">
                                    <label for="detallesIncidencia" class="form-label">Descripción de la
                                        Incidencia</label>
                                    <textarea class="form-control" id="detallesIncidencia" rows="5" readonly></textarea>
                                    <div class="form-help-text">Descripción detallada del incidente</div>
                                    <div class="char-limit-info">
                                        <span class="char-counter" id="contadorCaracteres">0/1000</span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- SECCIÓN 2: IMÁGENES Y EVIDENCIAS -->
        <!-- ============================================= -->
        <div class="form-row" style="margin-top: 20px;">
            <div class="full-width">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-images"></i>Evidencias Fotográficas</h5>
                    </div>
                    <div class="card-body">
                        <!-- Vista de imágenes -->
                        <div class="images-preview-container">
                            <h6>
                                <i class="fas fa-images"></i>
                                Imágenes de la incidencia (<span id="imagenesCount">0</span>)
                            </h6>
                            <div class="images-grid" id="imagenesPreview">
                                <div class="no-images">
                                    <i class="fas fa-images"></i>
                                    <p>No hay imágenes disponibles</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <br>

                    <!-- Modal para ver imagen ampliada -->
                    <div id="imageViewerModal" class="modal">
                        <div class="modal-content" style="max-width: 900px;">
                            <div class="modal-header">
                                <h5><i class="fas fa-image"></i> Visualizar Imagen</h5>
                                <button type="button" class="modal-close" id="btnCerrarModal">&times;</button>
                            </div>
                            <div class="modal-body" style="text-align: center;">
                                <img id="modalImage" src="" alt="Imagen ampliada"
                                    style="max-width: 100%; max-height: 70vh;">
                                <div class="image-info" id="modalImageInfo" style="margin-top: 15px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Scripts -->
                    <script type="module" src="/components/themeloader.js"></script>
                    <script type="module" src="/components/particulas.js"></script>
                    <script src="/components/navbar-admin-component.js"></script>
                    <script src="/components/footer-admin-component.js"></script>
                    <script type="module" src="verIncidencias.js"></script>
</body>

</html>